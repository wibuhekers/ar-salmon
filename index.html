<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <title>AR Product Live</title>
    
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.1/dist/aframe-extras.min.js"></script>

    <style>
        body { margin: 0; overflow: hidden; font-family: sans-serif; }
        #loading-screen {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: #000;
            display: flex; justify-content: center; align-items: center;
            color: white; z-index: 999;
        }
        #instructions {
            position: fixed;
            bottom: 20px; left: 50%; transform: translateX(-50%);
            background: rgba(0,0,0,0.6);
            color: white; padding: 10px 20px; border-radius: 20px;
            z-index: 10; text-align: center; width: 80%;
        }
    </style>
</head>

<body>
    <div id="loading-screen">Memuat Kamera AR...</div>
    <div id="instructions">ðŸ“· Gerakkan HP Anda untuk melihat model salmon</div>

    <a-scene 
        embedded 
        arjs="sourceType: webcam; debugUIEnabled: false; displayWidth: 1280; displayHeight: 720;"
        vr-mode-ui="enabled: false"
        renderer="logarithmicDepthBuffer: true; colorManagement: true;">

        <a-assets>
            <a-asset-item id="salmon" src="salmon.glb"></a-asset-item>
        </a-assets>

        <a-entity id="model-container" position="0 -1 -5" rotation="0 0 0">
            <a-gltf-model 
                src="#salmon" 
                scale="1.5 1.5 1.5"
                animation-mixer
                id="salmon-model">
            </a-gltf-model>
        </a-entity>

        <a-light type="ambient" intensity="1"></a-light>
        <a-light type="directional" position="1 1 1" intensity="0.5"></a-light>

        <a-entity camera></a-entity>
    </a-scene>

    <script>
        window.addEventListener('camera-init', (data) => {
            console.log('Kamera Terdeteksi');
            document.getElementById('loading-screen').style.display = 'none';
        });

        window.addEventListener('camera-error', (error) => {
            console.error('Kamera Error:', error);
            alert('Gagal akses kamera. Pastikan menggunakan HTTPS dan memberi izin kamera.');
        });

        // Logika untuk memastikan model mengikuti pandangan awal
        document.querySelector('a-scene').addEventListener('loaded', function () {
            console.log('Scene Loaded');
        });
    </script>
</body>
</html>
